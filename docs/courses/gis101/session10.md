---
title: جلسه ۱۰ - تحلیل شبکه
---
در ادامه جلسه پیش، این جلسه قرار است به گزینه دیگری از ابراز selection بپردازیم:
# select by location
از این ابزار برای سلکت کردن بر اساس لایه ترسیمی و موقعیت لایه‌ها نسبت به هم استفاده می‌کنیم.
در ابتدا لایه گسل را اضافه می‌کنیم
در select by lacation در قسمت input لایه ای که می‌خواهیم انتخاب در آن صورت گیرد
و در selecting features لایه‌ای که انتخاب قرار است بر اساس آن صورت گیرد را انتخاب می‌کنیم.
در بخش relationship با چندین گرینه مواجه هستیم:
![select by location](https://i.postimg.cc/yx8TPQ8F/Screenshot-375.png)

Intersect: قطعاتی که گسل از رویشان رد می‌شود
Within a distance: قطعاتی با فاصله از گسل
Contains: قطعاتی که دقیقا داخل محدوده قرار دارد
برای مثال می‌توانیم قطعاتی که با فاصله ۱۵۰ متری از گسل هستند را انتخاب کنیم و برای و برای بررسی اینکه این قطعات چه کاربری‌ای دارند:
روی لیبل در جدول کاربری کلیک راست می‌کنیم و به کمک سامرایز و انتخاب count تعداد را در می‌یابیم.
تمرین:انتخاب قطعاتی که در ۱۵۰ متری گسل هستند اما روی گسل نیستند
در مرحله اول درست مانند قسمت قبل به کمک whithin a distance  و selection type روی new selection مواردی با فاصله ۱۵۰ متری را سلکت میکنیم دوباره به کمک همان ابزار این بار روی remive fropm و intersect مواردی که روی گسل هستند از انتخاب های قبلی حذف می‌کنیم.
# دائمی کردن سلکت
همانطور که در جلسه پیش گفته شد یکی از راه های این کار تشکیل فیلد جدید به اسم گسل است.
آنهایی که گسل از آنها رد شده است را ۱ می‌نامیم و آنهایی که با فاصله ۱۵۰ متری است و گسل از آنها عبور نکرده را ۲ می‌نامیم
ابتدا هر کدام از موارد مورد نظر را انتخاب میکنیم و سپس با راست کلیک و calculate شماره مورد نظر را وارد می‌کنیم.
# تهیه نقشه
برای تهیه نقشه از این موارد روی لایه موجود ملیک راست می‌کنیم و به وسیله symbology و سپس unique values فیلد گسل را انتخاب می‌کنیم و شماره یک را رنگ قرمز و شماره دو را رنگ زرد قرار می‌دهیم.
![نقشه گسل](https://i.postimg.cc/mZ7cXNHM/Screenshot-390.png)
# گزارش در اکسل
ابتدا از جدول موجود خروجی با پسوند .csv می‌گیریم و در اکسل به کمک pivot 
لیبل‌ها را در rows 
و فیلد را در columns می‌کشیم
براب پر کردن این جدول shape area را در قسمت values قرار میدهیم و با کلیک روی آن و انتخاب گزینه value field setting  قرار دادن روی count جدول را پر می‌کنیم.
![گزارش اکسل](https://i.postimg.cc/dV3VY8L3/Screenshot-391.png)
برای بخش دوم selection از فایل mokhateraat فایل های گسل را وارد می کنیم![pic1](https://github.com/user-attachments/assets/d56e6b62-65a9-4a7a-b25f-c6efb2bb6ce2)
 همراه با لایه ی کاربری.![pic2](https://github.com/user-attachments/assets/72e7a52f-e6fb-4554-81ae-f01493130df0)
 سپس روی گزینه ی select by location کلیک می کنیم و input features را روی لایه ی کاربری قرار می دهیم. و سپس selecting feature را روی گسل تنظیم می کنیم. relationsip را هم interset انتخاب می کنیم![pic3](https://github.com/user-attachments/assets/f72dcd23-6fe0-47d5-b781-2505443e6bb5![pic7](https://github.com/user-attachments/assets/686c5b90-edd7-4973-970f-64657d0638ac)
)
 و اوکی را می زنیم. برای بار دوم روی select by location کلیک می کنیم. input features و output features را ثابت نگه داشته اما این بار relationship را روی within a distance تنظیم می کنیم![pic4](https://github.com/user-attachments/assets/bfe5c1d5-6d0c-4ecf-a72d-7e01557210cc![pic5](https://github.com/user-attachments/assets/c69932ef-2e7d-4c23-abc6-56a74b69bc7e)
)
 در مرحله ی بعدی همه ی گزینه ها را ثابت نگه می داریم و relationship را روی have the center in تنظیم می کنیم![pic6](https://github.com/user-attachments/assets/d8bd2416-740b-47f2-91eb-b2a516a31a76)
 اما در این مرحله متاسفانه فایل کاربری ارور داد و من مجبور شدم از فایل کاربری دیگری استفاده کنم. فقط در این پنجره search distance را روی 150 تنظیم می کنیم. حال می خواهیم بفهمیم که اون لایه هایی که گسل روشونه کاربریشون چیه. در لایه ی کاربری راست کلیک می کنیم و گزینه ی data را انتخاب می کنیم و سپس export features را انتخب کرده و output  را روی گسل می گذاریم. selected features را تیک می زنیم و اوکی را می زنیم. باز دوباره select by location را انتخاب می کنیم و تمام گزینه ها را همان قبلی ها تنظیم می کنیم. اما در بخش selection type ،  remove from the current selection را می زنیم اما سرچ دیستنس را خالی می گذاریم. حال باید رنگ ها را تغییر دهیم اون هایی که خیلی در خطر هستند قرمز، و بقیه نارنجی. جدول لایه ی کاربری را باز کرده . و از جدول موجود یک اکسپورت می گیریم حالا برای جدول دوباره select by location را انتخاب کرده و همه ی گزینه ها را نگه داشته هیچ distance ای هم انتخاب می کنیم و اوکی را می زنیم. سپس add field را می زنیم و یک فیلد جدید با نام field 2  ایجاد می کنیم![pic10](https://github.com/user-attachments/assets/c036c5b6-20d6-4fce-9348-0860e2066cfa)
 و سپس این پنجره را بسته تا ستون چدید در جدول اصلی ظاهر شود. روی این فیلد جدید راست کلیک کرده و گزینه ی calculate field را انتخاب می کنیم در ان قسمت جای خالی عد 2 را وارد کرده![pic11](https://github.com/user-attachments/assets/3b543a25-0117-4b4c-b2b1-23891eef78b0)
 و سپس اوکی را می زنیم حال با فرمت .csv از این جدول اکسپورت می گیریم.![pic12](https://github.com/user-attachments/assets/3e679900-22ca-458f-8b88-fdd184fdcaa2)
 حال فایل را در اکسل باز می کنیم![pic13](https://github.com/user-attachments/assets/3c2f243c-03f8-4448-9153-2854e6e4ed63)
 و پیووت تیبل را می زنیم تا نوار سمت چپ برای ما باز شود. لیبل را در rows. می اندازیم و shape area را در  values  می اندازیم سپس دابل کلیک کرده و روی value field setting کلیک می کنیم![pic 14](https://github.com/user-attachments/assets/949bccf2-f1f8-4c19-967b-10115bc44c7f)
 و به جای sum گزینه ی count را انتخاب می کنیم![pic15](https://github.com/user-attachments/assets/087232b4-ebfb-4071-91fb-755573bf53da)
.

## اجرای Select by Location
1. لابه کاربری و گسل را باز می‌کنیم.
2. در قسمت **map**، پنجره **select by location** را باز می‌کنیم.
3. در پنجره باز شده:

- **Input Features:** لایه‌ای که می‌خواهیم انتخاب در آن انجام شود → `کاربری`  
- **Selecting Features:** لایه‌ای که بر اساس آن انتخاب انجام می‌شود → `گسل`  
گزینه‌های قسمت **relationship**:
- `Intersect`: انتخاب تمام عوارضی که با گسل‌ها تقاطع دارند.
- `Within a Distance`: انتخاب عوارضی که در فاصله‌ی مشخصی از گسل‌ها هستند.

| **Intersect** | هر عارضه‌ای که حتی بخش کوچکی از آن با لایه دیگر تداخل دارد، انتخاب می‌شود. |
| **Within a distance** | فقط عوارضی انتخاب می‌شوند که در فاصله مشخصی از لایه دیگر قرار دارند. |
| **Contain** | تنها زمانی انتخاب می‌شود که کل قطعه داخل محدوده باشد (خیلی سخت‌گیرانه). |
| **Centered in** | گزینه‌ای بینابین؛ وقتی مرکز قطعه در محدوده باشد انتخاب می‌کند. |
| **3D options** | در صورت داشتن داده سه‌بعدی قابل استفاده‌اند. |

برای مثال:
- Relationship = `Within a Distance`
- **Distance:** `150 meters`

سپس OK را می‌زنیم. 

---
یعنی ۳۷ قطعه از لایه کاربری در فاصله ۱۵۰ متری از گسل‌ها قرار دارند.

---

## خروجی گرفتن از انتخاب‌ها

برای ذخیره‌ی فقط همان قطعات انتخاب‌شده:

1. روی لایه‌ی کاربری راست کلیک می‌کنیم.  
2. روی گزینه **data** و سپس **export features** کلیک می‌کنیم.
3. در قسمت **output feature class** نام موردنظر خود را وارد می‌کنیم.
4. پس از زدن **OK**، لایه جدید فقط شامل قطعات انتخاب شده ساخته می‌شود.

---

---

## انواع Relationship در Select by Location


- اگر از `Intersect` به‌تنهایی استفاده کنیم ممکن است قطعاتی انتخاب شوند که فقط بخشی کوچک از آن‌ها در محدوده‌اند و در واقع در حریم خطر نیستند.  
برای همین معمولاً از **Within a Distance** یا **Centered in** استفاده می‌کنیم.

---

##  حذف یا ترکیب انتخاب‌ها (Selection Type)

در همان ابزار Select by Location قسمت **Selection Type** گزینه‌های زیر را داریم:

- **New selection:** ایجاد انتخاب جدید (انتخاب قبلی حذف می‌شود).  
- **Add to selection:** اضافه کردن انتخاب جدید به انتخاب قبلی.  
- **Remove from selection:** حذف انتخاب‌های مشخص‌شده از انتخاب قبلی.

- برای مثال:
1. ابتدا `New Selection` برای ۱۵۰ متر از گسل انجام می‌دهیم.  
2. سپس دوباره `Select by Location` را اجرا می‌کنیم ولی این بار `Remove from selection` را انتخاب می‌کنیم تا قطعات روی خود گسل حذف شوند.

---

## جداسازی با فیلد جدید
1. در جدول کاربری موجود طرح جامع، یک فیلد جدید ایجاد می‌کنیم.
2.  در قسمت **alias** نام "gosal" را انتخاب کرده و سیو می‌کنیم. 

سپس:
- روی فیلد جدید راست‌کلیک → Calculate Field  
- روی فیلد جدید دابل کلیک می‌کنیم تا انتخاب شود و سپس **OK** را می‌زنیم.

بعد با روش دو‌مرحله‌ای بالا (Select by Location → New و Remove)  
قطعاتی که **در حریم گسل نیستند** را جدا کرده و مقدار `2` برایشان قرار می‌دهیم.

---

## خروجی گرفتن جدول و تحلیل در Excel

1. در جدول Attribute Table → گزینه **Export Table** را می‌زنیم.  
2. فایل را با فرمت `.csv` ذخیره می‌کنیم (ترجیحاً در پوشه‌ی `Output`).  
3. فایل CSV را در Excel باز می‌کنیم.

---

##  ساخت Pivot Table در Excel

برای تحلیل آماری داده‌ها:

1. از منوی بالا **insert** و سپس **pivot table** را انتخاب می‌کنیم.
2.  در پنجره باز شده:
   - فیلد **Label** را به قسمت Rows می‌بریم.
   - یکی از فیلدهای عددی مثل `Shape_Area` را به قسمت Values می‌بریم.
3. روی **Shape_Area** در Pivot دابل‌کلیک می‌کنیم → `Value Field Settings`
4. به جای `Sum` گزینه `Count` را انتخاب می‌کنیم تا تعداد قطعات را بشمارد.

به این ترتیب می‌توانیم ببینیم چه تعداد قطعه از هر نوع کاربری در محدوده گسل یا خارج از آن قرار دارند.




