---
title: جلسه ۱۰ - تحلیل شبکه
---

## اجرای Select by Location
1. لابه کاربری و گسل را باز می‌کنیم.
2. در قسمت **map**، پنجره **select by location** را باز می‌کنیم.
3. در پنجره باز شده:

- **Input Features:** لایه‌ای که می‌خواهیم انتخاب در آن انجام شود → `کاربری`  
- **Selecting Features:** لایه‌ای که بر اساس آن انتخاب انجام می‌شود → `گسل`  
گزینه‌های قسمت **relationship**:
- `Intersect`: انتخاب تمام عوارضی که با گسل‌ها تقاطع دارند.
- `Within a Distance`: انتخاب عوارضی که در فاصله‌ی مشخصی از گسل‌ها هستند.

| **Intersect** | هر عارضه‌ای که حتی بخش کوچکی از آن با لایه دیگر تداخل دارد، انتخاب می‌شود. |
| **Within a distance** | فقط عوارضی انتخاب می‌شوند که در فاصله مشخصی از لایه دیگر قرار دارند. |
| **Contain** | تنها زمانی انتخاب می‌شود که کل قطعه داخل محدوده باشد (خیلی سخت‌گیرانه). |
| **Centered in** | گزینه‌ای بینابین؛ وقتی مرکز قطعه در محدوده باشد انتخاب می‌کند. |
| **3D options** | در صورت داشتن داده سه‌بعدی قابل استفاده‌اند. |

برای مثال:
- Relationship = `Within a Distance`
- **Distance:** `150 meters`

سپس OK را می‌زنیم. 

---
یعنی ۳۷ قطعه از لایه کاربری در فاصله ۱۵۰ متری از گسل‌ها قرار دارند.

---

## خروجی گرفتن از انتخاب‌ها

برای ذخیره‌ی فقط همان قطعات انتخاب‌شده:

1. روی لایه‌ی کاربری راست کلیک می‌کنیم.  
2. روی گزینه **data** و سپس **export features** کلیک می‌کنیم.
3. در قسمت **output feature class** نام موردنظر خود را وارد می‌کنیم.
4. پس از زدن **OK**، لایه جدید فقط شامل قطعات انتخاب شده ساخته می‌شود.

---

---

## انواع Relationship در Select by Location


- اگر از `Intersect` به‌تنهایی استفاده کنیم ممکن است قطعاتی انتخاب شوند که فقط بخشی کوچک از آن‌ها در محدوده‌اند و در واقع در حریم خطر نیستند.  
برای همین معمولاً از **Within a Distance** یا **Centered in** استفاده می‌کنیم.

---

##  حذف یا ترکیب انتخاب‌ها (Selection Type)

در همان ابزار Select by Location قسمت **Selection Type** گزینه‌های زیر را داریم:

- **New selection:** ایجاد انتخاب جدید (انتخاب قبلی حذف می‌شود).  
- **Add to selection:** اضافه کردن انتخاب جدید به انتخاب قبلی.  
- **Remove from selection:** حذف انتخاب‌های مشخص‌شده از انتخاب قبلی.

- برای مثال:
1. ابتدا `New Selection` برای ۱۵۰ متر از گسل انجام می‌دهیم.  
2. سپس دوباره `Select by Location` را اجرا می‌کنیم ولی این بار `Remove from selection` را انتخاب می‌کنیم تا قطعات روی خود گسل حذف شوند.

---

## جداسازی با فیلد جدید
1. در جدول کاربری موجود طرح جامع، یک فیلد جدید ایجاد می‌کنیم.
2.  در قسمت **alias** نام "gosal" را انتخاب کرده و سیو می‌کنیم. 

سپس:
- روی فیلد جدید راست‌کلیک → Calculate Field  
- روی فیلد جدید دابل کلیک می‌کنیم تا انتخاب شود و سپس **OK** را می‌زنیم.

بعد با روش دو‌مرحله‌ای بالا (Select by Location → New و Remove)  
قطعاتی که **در حریم گسل نیستند** را جدا کرده و مقدار `2` برایشان قرار می‌دهیم.

---

## خروجی گرفتن جدول و تحلیل در Excel

1. در جدول Attribute Table → گزینه **Export Table** را می‌زنیم.  
2. فایل را با فرمت `.csv` ذخیره می‌کنیم (ترجیحاً در پوشه‌ی `Output`).  
3. فایل CSV را در Excel باز می‌کنیم.

---

##  ساخت Pivot Table در Excel

برای تحلیل آماری داده‌ها:

1. از منوی بالا **insert** و سپس **pivot table** را انتخاب می‌کنیم.
2.  در پنجره باز شده:
   - فیلد **Label** را به قسمت Rows می‌بریم.
   - یکی از فیلدهای عددی مثل `Shape_Area` را به قسمت Values می‌بریم.
3. روی **Shape_Area** در Pivot دابل‌کلیک می‌کنیم → `Value Field Settings`
4. به جای `Sum` گزینه `Count` را انتخاب می‌کنیم تا تعداد قطعات را بشمارد.

به این ترتیب می‌توانیم ببینیم چه تعداد قطعه از هر نوع کاربری در محدوده گسل یا خارج از آن قرار دارند.




