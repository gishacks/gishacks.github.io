---
title: توضیح spatial join- relate- و تحلیل مطلوبیت
---
# ابزار spatial join

تفاوت این ابزار با موارد یاد شده در جلسات گذشته این است که پیش‌تر از ابزار جوین بر اساس داده‌های توصیفی در جدول لایه‌ها استفاده می‌کردیم؛ اما از spatial join بر اساس موقعیت مکانی و تطابق مکانی دو لایه استفاده می‌کنیم.

مثال: میخواهیم بدانیم که در محلات تهران، به تفکیک هر محله، در هر محله چند بیمارستان وجود دارد؛ ابتدا دو لایه محلات و بیمارستان‌ها را باز می‌کنیم:

righ click on Mahallat/ joins and relates/ add spatial join/ target features: Mahallat/ join features: Bimarestan/ match option: intersect/ ok

در این مرحله با باز کردن جدول لایه محلات می‌بینیم که فیلد join count اضافه شده است که نشان دهنده تعداد بیمارستان در هر محله است. حالا باید این فیلد را طبق آموزش‌هایی که پیش‌تر بیان شد دائمی کنیم و remove all joins را انتخاب کنیم.

حالا برای بدست آوردن جمعیت هر محله نیز همین مراحل را تکرار می‌کنیم اما با این تفاوت که در پنجره add spatial join در پایین پنجره fields را انتخاب می‌کنیم و همه فیلدها را حذف می‌کنیم و add fields را انتخاب کرده و فیلد جمعیت را انتخاب می‌کنیم و از select action(s)، مجموع (sum) را انتخاب می‌کنیم و ok را می‌زنیم و سپس فیلد را دائمی کرده و جوین‌ها را حذف (remove) می‌کنیم.

# یافتن بحرانی‌ترین محله

بحرانی‌ترین محله، محله‌ای است که بیشترین جمعیت، کمترین تعداد بیمارستان، و بیشترین حریم گسل را داشته باشد.

برای این امر برای هرکدام از این معیارها، با استفاده از graduated colors طیف رنگی‌ای استفاده می‌کنیم که برای دیگر معیارها نیز مانند هم باشد؛ سپس با استفاده از تب feature layer و layer blend، حالت را روی multiply می‌گذاریم و سپس هر محله‌ای که پررنگ‌تر بود را بحرانی‌ترین محله در نظر می‌گیریم.
![توضیح تصویر](https://www.dropbox.com/scl/fi/zlwikzuea29opprvndi2a/WhatsApp-Image-2025-12-01-at-00.05.57.jpeg?rlkey=wxrfgx7nkhrypgogo34a7o3vh&st=861wb3ft&dl=0)

# ابزار relate

برای ارتباط دادن دو جدول بر اساس یک فیلد مشترک، از این ابزار استفاده می‌کنیم.
لایه‌های حوزه و بلوک جمعیتی ۷۵ را باز می‌کنیم و روی یکی از آن‌ها کلیک‌راست می‌کنیم:
joins and relates/ add relate/ layer name or table view: (examle) jamiat houzeh 75/ input relate field: censuzone/ relate table: jamiat block 75/ output relate field: markaz_hoz/ ok
**معمولا فیلدهای مشترک censuzone و markaz hoz هستند.**
حالا با استفاده از سه خط بالا سمت چپ جدول، related data را انتخاب می‌کنیم و می‌توانیم داده‌های مرتبط در جدول دیگر را هم ببینیم درحالیکه در جدول در حالت انتخاب هستند.
با انتخاب کردن هر قسمت از نقشه، پنجره pop-up باز می‌شود و می‌توانیم حوزه‌های موجود در هر بلوک را ببینیم.
![توضیح تصویر](https://www.dropbox.com/scl/fi/bxwbv8cp94hgwc2ogi7dw/WhatsApp-Image-2025-12-01-at-01.04.50.jpeg?rlkey=aww8mpxjbacdwpnvkyynxd37j&st=q0bdt0sk&dl=0)

#ابزار label

برای نشان دادن داده‌های توصیفی روی نقشه از این ابزار استفاده می‌کنیم.
برای لیبل زدن (بطور مثال برای جمعیت):
right click on (example) jamiat/ lable properties/ fields: population/ right click on jamiat (again)/ lable
همچنین می‌توانیم از تب labeling و label placement style مکان لیبل‌ها را تعیین و تغییر دهیم.

#استفاده از sql query

labeling tab/ SQL query/ تعریف داده‌هایی که می‌خواهیم؛ مثلا قطعاتی که مساحت کمتر از یک عدد خاصی هستند را فقط لیبل بزنیم
![توضیح تصویر](https://www.dropbox.com/scl/fi/82t33458bmh2iz0uhu594/WhatsApp-Image-2025-12-01-at-01.47.13.jpeg?rlkey=ow5clho1p8skd5wv2fck659x3&st=b1pxn7ac&dl=0)
**برای تنظیمات لیبل برای زبان فارسی:**
lable class window/ symbol/ formatting/ paragraph/ فعال کردن همه تیک‌ها/ internationalization/ text direction: right to left
 **همچنین در قسمت label class می‌توانیم محدودیت‌های بصری را از طریق تنظیمات مقیاس انجام دهیم.**
 
 

# تحلیل مطلوبیت

تحلیل مطلوبیت یکی از روش‌های پایه در ارزیابی‌های مکانی است؛ این امر با استفاده از مجموعه‌ای از معیارهای مناسب، شرایط موجود را بررسی کرده و میزان مناسب‌ بودن هر موقعیت را برای هدفی که مورد نظر داریم مشخص می‌کند. این تحلیل بر اساس یک روند سیستماتیک انجام می‌شود و هر مرحله از این سیستم مبتنی بر معیارها، استاندارد ساختن داده‌ها و ترکیب آن‌هاست. 

##آشنایی با ابزار model builder
برای ثبت بصری معیارها از این ابزار استفاده می‌شود.
analysis/ model builder
در این قسمت:
analysis tab/ geoprocessing/ toolboxes/ proximity/ buffer
حال buffer را درگ کرده و در صفحه‌ای که با انتخاب model building ایجاد شده‌است می‌بینیم که اشکالی شکل گرفته.
برای وارد کردن داده‌ها به اشکال‌مان روی مستطیل buffer دابل کلیک می‌کنیم و داده ورودی را (مثلا لایه gosal) قرار می‌دهیم (در input feature) و فاصله را هم تعیین می‌کنیم.
اگر هم خواستیم از ابزار identity استفاده کنیم می‌توانیم آن را هم از قسمت overlay درگ کنیم و identity feature را لایه محلات قرار دهیم
بیضی‌ها نشان‌دهنده ورودی‌ها و خروجی‌ها هستند؛ و مستطیل‌ها نشان‌دهنده دستورات هستند.
ورودی‌ها آبی، خروجی‌ها سبز و دستورات نیز زرد هستند.
برای مرتب کردن دیاگرام نیز می‌توانیم وارد تب modelbuilder شویم و auto layout را انتخاب کنیم و در نتیجه می‌توانیم ببینیم که دیاگرام‌مان مرتب شده است.

## اجرای مدل یا اجرای گام‌به‌گام
برای اجرای کل مدل یا بخشی از آن، روی مستطیل کلیک‌راست می‌کنیم و run را انتخاب می‌کنیم. اگر پس از این کار زیر اشکل‌مان سایه افتاد یعنی کار را به‌درستی انجام دادیم.

##دیدن نتایج/ نتیجه
برای دیدن نتایج، روی خروجی ساخته‌شده، کلیک‌راست می‌کنیم و add to display را انتخاب می‌کنیم. سپس جدول توصیفی (attribute table) آن لایه را باز می‌کنیم تا داده‌ها و فیلدهای جدید را مشاهده کنیم و ببینیم.
![توضیح تصویر](https://www.dropbox.com/scl/fi/nckbzjk37boq2kpaxb99c/WhatsApp-Image-2025-12-01-at-23.04.40.jpeg?rlkey=153hwl36jysltmmpmxyria74r&st=co5xilcj&dl=0)

![توضیح تصویر](https://www.dropbox.com/scl/fi/ee7wr0yn6bdtq4f98pnjh/WhatsApp-Image-2025-12-01-at-23.05.52.jpeg?rlkey=q2vria0rsoob0xjlln9am2q50&st=53hj0fdb&dl=0)
