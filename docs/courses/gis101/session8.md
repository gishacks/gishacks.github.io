---
title: جلسه ۸ - تحلیل مطلوبیت
---
# ابزار select by attribute و کاربردهای آن

##معرفی این ابزار
ابزار select by attribute به ما کمک می‌کند که با توجه به داده‌های جدول که متصل به نقشه ماست، قطعات و داده‌های خاص و منتخب خود را به دلخواه خود انتخاب کنیم.

### معرفی selection type
اگر A را دسته اول انتخاب و B را  دسته دوم انتخاب‌مان در نظر بگیریم:
new selection: ایجاد انتخاب A
add to the current selection: AUB
remove from the current selection: A-B
select subset from the current selection: اشتراک A, B

### نحوه انتخاب
در قسمت where دسته و فیلد مورد نظرمان برای تغییرات را انتخاب می‌کنیم
در بخش وسط، گزینه‌هایی مانند is equal to, is greater than, contains the text ,... وجود دارد که با آن نوع داده‌هایی که میخواهیم را مشخص می‌کنیم؛ مانند اعداد بزرگ‌تر یا کوچک‌تر از یک حدی، داده‌هایی با فلان اسم و... سپس در قسمت سمت راست، حد مورد نظر خودمان را قرار می‌دهیم و apply را انتخاب می کنیم و اگر درخواست با مشکلی مواجه نشد، ok را می‌فشاریم و داده‌های انتخاب می‌شوند و در جدول attribute می‌توانیم موارد انتخاب‌شده را نظاره کنیم.
حال، اگر ترکیب یا اشتراک دو یا چند داده را می‌خواهیم بدست بیاوریم، گزینه add clause را انتخاب می‌کنیم. and به معنای اشتراک انتخاب‌هاست و  or به معنای اجتماع انتخاب‌هاست.

### مثال
بطور مثال اگر بخواهیم داده‌هایی را انتخاب کنیم که چنین‌اند: کاربری‌های مسکونی که زیر ۲۰۰ متر مربع مساحت دارند، باید در ابتدا کاربری‌های مسکونی را با حالت is equal to (landuse: مسکونی) انتخاب کنیم و انتخاب بعدی را اضافه کنیم و آن را روی حالت and قرار دهیم و سپس فیلد shape area را انتخاب کنیم و آن را در حالت is less than 200 قرار دهیم؛ و سپس apply و ok را بزنیم.

### نمایش داده‌های منتخب برای مراحل و پروژه‌های بعدی
یکی از رایج‌ترین مراحل برای این امر، خروجی گرفتن از لایه است؛ اما یکی دیگر از راه‌های پیشنهادی، استفاده از definition query است. استفاده از این قابلیت، به ما این امکان را می‌دهد که هر موقع به داده‌های منتخب نیاز داشتیم، آن را به نمایش بگذاریم و بررسی کنیم. برای استفاده از این قابلیت باید روی لایه نقشه مورد نظرمان راست کلیک کنیم و از بخش properties به قسمت definition query برویم و در آنجا، آن حالت منتخب که با استفاده از select by attribute در نظر گرفتیم را پیاده کنیم و سپس با تیک زدن یا برداشتن آن تیک، می‌توانیم داده‌ها را فعال یا غیر فعال کنیم.

# ابزار select by location 
این ابزار به ما کمک می‌کند که نقطه یا نقاط روی نقشه را با داده‌هایی که مشخص می‌کنیم، انتخاب کنیم و ببینیم. برای اینکار در تب مپ، select by location را انتخاب می‌کنیم، relationship را روی گزینه‌های مختلفی می‌توانیم بگذاریم که عبارتند از: 
intersect: انتخاب عوارضی که با آن چیزی که انتخاب کردیم تقاطع دارند
contains: عوارضی که کاملا داخل محدوده باشند یا شامل آن محدوده باشند( به طور مثال کاملا در فاصله ۱۵۰ متری)
within: عوارضی که کاملا داخل محدوده باشند
have their center in: عوارضی که داخل محدوده قرار دارند

## تدوین یک پروژه
میخواهیم با استفاده از نقشه گسل‌های منطقه ۱ تهران، و نقشه کاربری‌های آن، گزارش و نقشه‌ای تهیه کنیم که نمایانگر این باشد که در فاصله ۱۵۰ متری گسل‌ها چه نوع و چه تعداد قطعات روی گسل یا در محدوده ۱۵۰ متری آن قرار دارند.
اگر بخواهیم دو بخش قطعاتی که دقیقا روی گسل هستند (A) را جدا از قطعاتی که در فاصله ۱۵۰ متری گسل قرار دارند و نه روی گسل (B): بدین شکل کار می‌کنیم:
A:select by location/ intersect/ distance:0
B: 1) select by location/ intersect/ distance: 150  2) select by location/ intersect/ distance: 0/ selection type: remove from the current selection
اما نکته مهم این است که قبل از این بخش یک فیلد جدید در جدول بسازیم و نام آن را gosal بگذاریم.
وقتی که A ساخته شد در همان حالت انتخاب، با کلیک راست روی گسل میزنیم و calculate field را انتخاب می‌کنیم و آن را مساوی با ۱ میگذاریم؛ برای B نیز همین ترتیب را رعایت کرده و عدد ۲ را به آن نسبت می‌دهیم.
حالا میتوانیم با استفاده از سیمبولوژی و حالت unique values به آن‌ها رنگ اختصاص دهیم تا نقشه‌مان منظم‌تر و خواناتر شود.
مثال نهایی:
![توضیح تصویر](https://www.dropbox.com/scl/fi/yyp7al6b6unz9nh17jp5a/IMG_9807.HEIC?rlkey=hd4awnj0xxp8df7wazvq6oxv3&st=ftcw0u18&dl=0)
![توضیح تصویر](https://www.dropbox.com/scl/fi/mvdit5xsuog88fgarj41s/IMG_9808.HEIC?rlkey=afidgt4uxyg0x4mdequkbuc8f&st=93hkvaxq&dl=0)
سپس می‌توانیم با خروجی گرفتن از جدول با فرمت csv، آن را در اکسل باز کنیم و با استفاده از pivottable field list و از طریق آن، داده‌هایی مانند تعداد و نوع قطعاتی که در دسته A/B قرار می‌گیرند را خروجی بگیریم و همچنین یک گزارش کامل از نقشه خود تهیه کنیم.
# جلسه هشتم
# ریپورت گرفتن
insert > new report 
در ای قسمت سمت راست صفحه پنجره‌ای برای ما باز می‌شود که در 
صفحه اول) از ما خواسته می‌شود تمپلیت مورد نظر خود را انتخاب کنیم.
attribute برای گزارش توصیفی
by grouping دسته بندی انجام می‌دهد
basic summary برای خلاصه کردن
page per feature هر فیچر در یک صفحه جداگانه قرار می‌گیرید
در صفحه دوم) جدولی که میخواهیم از آن ریپورت گرفته شود را انتخاب می‌کنیم.
در صفحه سوم) فیلدهایی ه می‌خواهیم در ریپورت باشد انتخاب می‌کنیم.
می‌توانیم finish را انتخاب کنیم و گزارشی بای ما تهیه می‌شود، در این بخش می‌توانیم به نحوی که می‌خواهیم چینش مد نظر خود را پیاد کنیم.
در بخش preview گزارش نهایی قابل مشاهده است.
# presentation
insert > new presentation
در بخش insert pages مپ‌های مد نظر خود را اد می‌کنیم.
در این بخش می‌توانیم روی صفحه راست کلیک کنیم و activate را انتخاب کنیم در بالای همان مپ کنار ضربدر گزینه ای وجود دارد که با کلیک بر روی آن می‌توان همان صفحه را به ارائه اضافه کرد.
با کلیک راست  انتخاب transition و fly می‌توان از یک لایه به یک لایه دیگر پرواز کرد.
# خروجی برای اکسل
در تب تیبل اکسپورت تیبل می‌کنیم و پس از اسم گزاری آن را با فرمت .csv ذخیره می‌کنیم.
یا از جعبه ابزار گزینه conversion tools استفاده می‌کنیم.
# pivot
insert > pivot table 
می‌توانیم تغییراتی از قبیل جابه‌جا کردن سطر و.. اعمال کنیم.
برای جلسه ی هشتم به presentation می رسیم. اول از همه طبق روال فبلی یک نقشه را باز کرده و سپس روی آن نقشه کار را شروع می کنیم. در تب insert روی بخش presentation کلیک می کنیم تا اولین صفحه ی presentation ما درست شود.![pic1](https://github.com/user-attachments/assets/8b6ddff4-7a5b-4dfd-855d-91e688f9fd01)
 در نوار چپ یک گزینه ی insert page می بینیم اگر روی آن کلیک کنیم اسلاید جدیدی از نقشه تهیه می شود حال برای اینکه این اسلاید دوم زوم تر روی یک محله باشد به پنل نقشه ی خود بر می گردیم و روی نقشه زوم می کنیم. الان که به پنل presentation برگردیم می بینیم که اسلاید جدید روی یک محدوده زوم تر است.![pic2](https://github.com/user-attachments/assets/a302bc06-bc4e-4d7a-b03c-5ca204da5599)
 در تب insert روی new report کلیک می کنیم(روی لایه ی خود نقشه) ، سپس در نواری که در سمت چپ صفحه باز می شود data source را روی خود لایه انتخاب می کنیم که تعیین کنیم چه چیزی را می خواهیم نشان دهیم. next را انتخاب می کنیم به بخش sorting و summary stats می رسیم![pic3](https://github.com/user-attachments/assets/2f6a166d-c207-4efd-ab7e-6d3be5fa1ec9)
 و دوباره next را کلیک می کنیم و سپس گزینه ی gouping per feature را انتخاب می کنیم این نشان می دهد که برای هر عارضه یک صفحه درست کند.![pic4](https://github.com/user-attachments/assets/545fea7f-d04a-4cba-b832-d2ed7a26869c![pic5](https://github.com/user-attachments/assets/26cd49f3-61ea-4715-b34e-a946f80b9300)
)
 حال با کمک transition سعی می کنیم اسلاید را fly بدهیم.![pic6](https://github.com/user-attachments/assets/a1e5289b-c8f5-43a9-9e90-d0ff488187c0)
 از تب presentation گزینه ی full screen را انتخاب کرده و سپس می توانیم اراِعه را پخش کنیم. در مرحله ی آخر در تب table گزینه ی export table را انتخاب می کنیم![pic7](https://github.com/user-attachments/assets/9ef46319-821d-4744-a8f2-f96d0226f629)
 و در یک جایی با نام table.csv سیو می کنیم(فرمت را خودمان دستی وارد می کنیم) این مرحله در output table اتفاق می افتد.در مرحله ی آخر جدول را باز می کنیم.
