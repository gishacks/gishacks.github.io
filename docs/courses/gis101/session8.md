---
title: جلسه ۸ - تحلیل مطلوبیت
---
# جلسات 23 و 25 آذر: ادامه مراحل تحلیل مطلوبیت
به عنوان نمونه، قصد داریم مدرسه ابتدایی را مکان‌یابی کنیم.
مرحله دوم تحلیل مطلوبیت، یعنی مرحله امتیازدهی (Rating)، جایی است که ما داده‌های خام مکانی را از حالت صرفاً توصیفی خارج می‌کنیم و آن‌ها را به اطلاعات قابل مقایسه و قابل ترکیب تبدیل می‌کنیم. در این مرحله، هر معیار بر اساس میزان تأثیرش بر مکان‌یابی مدرسه ابتدایی، به‌صورت کمی و روی یک مقیاس مشترک ارزیابی می‌شود تا امکان تلفیق معیارهای مختلف در مراحل بعدی فراهم شود.

حال، معیارهایی که در کل پروژه داریم شامل:
### ·        تراکم جمعیت
### ·       فاصله از مدارس موجود
### ·        فاصله از گسل
### ·        شیب
### ·       آلودگی هوا
### ·       فاصله از پارک
در این مرحله، تمرکز ما فقط روی دو معیار فاصله از گسل و شیب است که می‌خواهیم آن‌ها را وارد مرحله دوم تحلیل مطلوبیت (Rating یا امتیازدهی) کنیم.

## 1-   استفاده از مدل قبلی و اضافه کردن شاخه جدید
ما از مدلی که قبلاً ذخیره کرده بودیم (مدل مربوط به شیب و مراحل قبل) استفاده می‌کنیم.

### ·       وارد Model Builder می‌شویم.
### ·       در همان مدل، یک شاخه جدید اضافه می‌کنیم.
### ·       در این شاخه جدید:
### ·       از ابزار Distance استفاده می‌کنیم.
### ·        لایه گسل را به ‌عنوان ورودی معرفی می‌کنیم.
### ·       در این شاخه جدید هیچ کاری با بخش Environment انجام نمی‌دهیم.

## 2-   تنظیم Environment در سطح مدل
بعد از اضافه شدن شاخه‌ها، می‌رویم سراغ تنظیمات کلی مدل:

### ·       در Model Builder > Environment:
### ·       در بخش Processing Extent، محدوده پردازش را بر اساس مناطق شهرداری تنظیم می‌کنیم (دقیقاً مطابق با توتریال قبلی).
### ·       در بخش Raster Analysis:
### ·        مقدار Cell Size را روی ۱۰۰ قرار می‌دهیم.

## 3-   ورود به مرحله دوم تحلیل مطلوبیت: Rating (امتیازدهی)
حال وارد مرحله دوم تحلیل مطلوبیت می‌شویم که همان امتیازدهی (Rating) هست.

**انتخاب خط‌کش معیار:**
### ·       خط‌کش امتیازدهی ما از منفی ۵ تا مثبت ۵ است:
### ·       ۵+ = مطلوب‌ترین حالت ممکن
### ·       ۵- = نامطلوب‌ترین حالت ممکن
**توجه:**
### ·       این‌ها حالت ممکن هستند، نه لزوماً حالت موجود.
### ·        مجبور نیستیم از همه نمره‌ها استفاده کنیم.
### ·        نامطلوب‌ترین حالت موجود، الزاماً برابر با نامطلوب‌ترین حالت ممکن نیست.

**منطق امتیازدهی معیارها**
بر اساس منطق کارشناسی:
### ·       فاصله از گسل: 
بیشترین فاصله از گسل → امتیاز ۵+
کمترین فاصله از گسل → امتیاز ۵-

### ·       شیب:
کمترین شیب → امتیاز ۵+
بیشترین شیب → امتیاز ۵-

**نکته مهم در صورت ران نشدن مدل**
اگر مدل اجرا نشد، مشکل معمولاً این است که ترتیب مراحل رعایت نشده. راه‌حل:

### ·       Project Raster را در مدل، به قبل از مرحله Topo to Raster و بعد از Raster to Point انتقال می‌دهیم. 
### ·       بعد از اصلاح این ترتیب، کل مدل را دوباره Run می‌کنیم.

## 4-   اجرای امتیازدهی با Reclassify
برای امتیازدهی، از ابزار زیر استفاده می‌کنیم:
Spatial Analyst > Reclass > Reclassify
این ابزار را دو بار به مدل اضافه می‌کنیم (برای دو شاخه).

### ·       ورودی‌ها:
Reclassify اول:

ورودی = خروجی شیب (Slope)

Reclassify دوم:

ورودی = خروجی Distance از گسل

**تنظیم پنجره ****Reclassify**
در پنجره Reclassify:
### ·        گزینه Classify را انتخاب می‌کنیم تا طبقات نمایش داده شوند.
### ·        در صورت نیاز، طبقه‌بندی را تغییر می‌دهیم.
در ستون New:
### ·        امتیاز هر طبقه را وارد می‌کنیم.

منطق امتیازدهی (در این مثال):
### ·       کم مقدارترین دسته: بیشترین نمره
### ·       به همین ترتیب، برای چهار طبقه بعدی هم امتیازها را تعیین می‌کنیم.
 این امتیازدهی کاملاً وابسته به تشخیص کارشناسی خودمان است:
### ·        لازم نیست همه امتیازها بین ۰ تا ۵ باشند.
### ·       حتی ممکن است لازم باشد برای بعضی طبقات امتیاز منفی بدهیم.
### ·        به آخرین ردیف (NoData یا آخرین کلاس) دست نمی‌زنیم.

## 5-   خروجی این مرحله
در پایان این مراحل، ما دو رستر امتیازدهی‌شده داریم:
### ·       یکی برای شیب
### ·        یکی برای فاصله از گسل
### ·        این دو خروجی آماده‌اند که در مراحل بعدی تحلیل مطلوبیت (وزن‌دهی و روی‌هم‌اندازی) استفاده شوند.

## 6-   مرحله سوم و چهارم تحلیل مطلوبیت: وزن‌دهی و روی‌هم‌اندازی معیارها
در این بخش وارد مرحله سوم و چهارم تحلیل مطلوبیت می‌شویم که شامل وزن‌دهی معیارها (Weighting) و روی‌هم‌اندازی (Overlay)
آن‌هاست. در ArcGIS Pro یک دستور وجود دارد که هر دوی این مراحل را به‌صورت هم‌زمان انجام می‌دهد.

**استفاده از دستور ****Weighted Overlay**

ابزاری که استفاده می‌کنیم:
Spatial Analyst > Overlay > Weighted Overlay
با اجرای این ابزار، پنجره Weighted Overlay باز می‌شود.

## 7-   پنجره Weighted Overlay
**معرفی مقیاس (****Scale****)**
در ابتدای پنجره:
### ·       Scale را معرفی می‌کنیم.
### ·       این Scale دقیقاً همان خط‌کش امتیازدهی است که در مرحله Reclassify استفاده کرده بودیم (مثلاً منفی ۵ تا مثبت ۵).

**اضافه کردن لایه‌های امتیازدهی‌شده**
کنار بخش Raster یک فلش رو به پایین وجود دارد.
### ·       روی آن کلیک می‌کنیم.

دو لایه Reclassify شده را انتخاب می‌کنیم:
### ·        رستر امتیازدهی‌شده شیب
### ·       رستر امتیازدهی‌شده فاصله از گسل

## 8-   وزن‌دهی معیارها
بعد از اضافه شدن لایه‌ها، ابزار از ما می‌پرسد که کدام معیار مهم‌تر است.

در بخش Percent Influence (ستون درصدها):
### ·       درصد اهمیت هر معیار را وارد می‌کنیم.
### ·       جمع درصدها دقت کنیم که باید ۱۰۰ باشد.
به‌عنوان مثال:
فاصله از گسل = ۷۰٪ اهمیت
شیب = ۳۰٪ اهمیت
### ·       بعد از تنظیم وزن‌ها، روی OK کلیک می‌کنیم و ابزار را Run می‌کنیم.

## 9-   مشاهده خروجی وزن‌دهی
پس از پایان پردازش:
### ·        روی لایه خروجی راست‌کلیک می‌کنیم.
### ·        گزینه Add To Display را انتخاب می‌کنیم.
### ·       وارد محیط Map می‌شویم و نتیجه تحلیل مطلوبیت را مشاهده می‌کنیم.
### ·       در پایان این مرحله، مدل را ذخیره می‌کنیم.

**پاسخ به سؤال اصلی پروژه**
**سؤال ما این است: مطلوب‌ترین محله برای ساخت مدرسه ابتدایی کجاست؟**
برای پاسخ به این سؤال، باید تحلیل را وارد مقیاس پارسل کنیم.

## 10- انتخاب پارسل‌های بایر
### ·       لایه کاربری اراضی را به پروژه اضافه می‌کنیم.
### ·       جدول توصیفی (Attribute Table) آن را باز می‌کنیم.
### ·        چون فقط پارسل‌های بایر برای ساخت مدرسه مناسب هستند:
### ·       از دستور Select By Attributes استفاده می‌کنیم.
### ·        فقط پارسل‌های بایر را انتخاب می‌کنیم.
بعد از انتخاب:
### ·        روی لایه کاربری راست‌کلیک می‌کنیم.
### ·        مسیر Data > Export > Export Features را می‌رویم.
### ·       خروجی پارسل‌های بایر را ذخیره می‌کنیم.

## 11- محاسبه امتیاز پارسل‌های بایر
برای این‌که بدانیم هر پارسل بایر چه امتیازی دارد، از ابزار زیر استفاده می‌کنیم:
Spatial Analyst > Zonal > Zonal Statistics as Table

**تنظیمات ابزار:**
### ·       Input Feature Zone Data: خروجی پارسل‌های بایر (Export Feature)
### ·       Input Value Raster: خروجی تحلیل مطلوبیت (Weighted Overlay)
### ·       Zone Field: یک فیلد منحصر‌به‌فرد برای هر پارسل: OBJECTID
### ·       Statistics Type: ALL
### ·       بعد از تنظیمات، ابزار را Run می‌کنیم.

## 12- بررسی جدول خروجی Zonal
یک جدول جدید در انتهای لیست Contents ساخته می‌شود.
در حالت صحیح:
تعداد رکوردهای جدول Zonal باید با تعداد پارسل‌های بایر انتخاب‌شده برابر باشد.
اما در پروژه ما:
چون Cell Size را ۱۰۰×۱۰۰ انتخاب کرده بودیم، بعضی پارسل‌ها آن‌قدر کوچک بودند که داخل هیچ سل رستری قرار نگرفتند
بنابراین محاسبه‌ای برای آن‌ها انجام نشده است.
نتیجه:
بهتر بود Cell Size کوچک‌تر (مثلاً ۱۰×۱۰) انتخاب می‌شد.

## 13- اتصال جدول Zonal به جدول پارسل‌های بایر (روی‌هم‌اندازی)
برای تحلیل نهایی، جدول Zonal را به جدول پارسل‌ها Join می‌کنیم.

**تنظیمات****Join****:**
### ·       Input Field: OBJECTID
### ·       Join Field: OBJECTID_1
### ·       تیک گزینه Keep All Input Records را برمی‌داریم تا فقط رکوردهای مرتبط باقی بمانند.

## 14- تحلیل و نمایش نتایج
فیلد mean را از بزرگ به کوچک (Descending) سورت می‌کنیم.
برای نمایش مکانی:
سیمبولوژی را بر اساس فیلد MEAN تنظیم می‌کنیم.

**نکته تحلیلی مهم:**
اگر بخواهیم میزان بارش یک منطقه را محاسبه کنیم، باید از SUM استفاده کنیم، نه MEAN.

## 15- پایان فرآیند
در نهایت:
ما می‌توانیم مطلوب‌ترین محله‌ها و پارسل‌ها را برای ساخت مدرسه ابتدایی شناسایی کنیم.
البته باید توجه داشته باشیم:
فرآیند تحلیل مطلوبیت واقعی بسیار پیچیده‌تر و چندمرحله‌ای‌تر از این است، اما در این پروژه، فرآیند تحلیل ما در همین نقطه به پایان می‌رسد.
