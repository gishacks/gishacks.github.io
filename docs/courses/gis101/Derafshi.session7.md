---
title: جلسه ۷-تحلیل موقعیت لایه‌ها
# جلسات 11 و 13 آبان: اجرای آنالیز Buffer و انتخاب‌ها

بعد از انتخاب لایه‌های مورد نظر ( در این مثال، لایه‌های کاربری، لایه گسل و لایه بیمارستان‌ها)، به تب Analysis رفته و پنل Tools را باز می‌کنیم.

## 1-   معرفی ابزارهای تحلیلی

در پنل Tools، مجموعه ابزارهای مربوط به تحلیل‌گرها (Analyst tools) را مشاهده می‌کنیم که مهم‌ترین ابزار برای ما Proximity می‌باشد که قرارگیری عوارض نسبت به یکدیگر را تحلیل می‌کند.
برای تحلیل فواصل و حریم یک عارضه، باید از ابزار Buffer در مجموعه Proximity استفاده کنیم.

**تفاوت نزدیکی و دسترسی:**
نزدیکی (Proximity) فاصله خطی است که مسیر را در نظر نمی‌گیرد.
دسترسی (Access) وقتی مطرح می‌شود که مسیر، شبکه و ارتباطات اهمیت داشته باشند، در این حالت باید از تحلیل شبکه یا Network Analysis استفاده کنیم.

## 2-   استفاده از Buffer

### ·       بعد از باز شدن پنجره Buffer، در قسمت input feature هم لایه نقطه‌ای، هم خطی و هم پولیگنی را می‌توانیم انتخاب کنیم. مثلا بیمارستان را انتخاب می‌کنیم.

### ·       در فیلد Distance فاصله مورد نظر را وارد می‌کنیم.

### ·       در قسمت Dissolve Type اگر بخواهیم دایره‌های ایجاد شده (حریم‌ها) که با هم برخورد می‌کنند و به اصطلاح با هم همپوشانی دارند، در هم ادغام شوند، گزینه Dissolve All را انتخاب می‌کنیم.

### ·       اما اگر بخواهیم فقط بافرهایی که اتریبیوت مشترک دارند ادغام شوند، از گزینه Dissolve feature using استفاده می‌کنیم.

## 3-   حریم‌های متفاوت
به عنوان مثال از Attribute table گسل‌ها استفاده می‌کنیم و می‌خواهیم گسل‌هایی که در فیلد Type مقدار 3 دارند، 150 متر؛ آن‌هایی که مقدار 6 دارند، 300 متر؛ بقیه 50 متر بافر بخورند.

**روش کار:**

### ·       یک فیلد جدید می‌سازیم.

### ·       از Select by attribute برای لایه گسل استفاده می‌کنیم و در فیلد بعدی Type را انتخاب کرده و هر کدام از رقم‌ها (3 و 6، با استفاده از Equal to) را select می‌کنیم.

### ·       سپس با استفاده از Calculate Field فاصله‌های مورد نظر را وارد می‌کنیم.
(برای انتخاب قطعاتی که مقابل آن‌ها نه رقم 3 و نه رقم 6 قرار گرفته، باید با استفاده از Select by Attribute اجتماع 3 و 6 را انتخاب کنیم (or) و بعد دوباره از Select by Attribute استفاده کرده و Selection Type را روی Switch قرار می‌دهیم.)

## 4-   بافر درجه‌بندی شده (Multiple Ring Buffer)
برای درجه‌بندی حریم‌ها (مثلا درجه 1= 100متر، درجه 2= 200متر و درجه 3= 500متر) از Multiple Ring Buffer استفاده می‌کنیم:

### ·       لایه مورد نظر را در Input feature انتخاب می‌کنیم. (مثلا گسل)

### ·       مقادیر را در فیلد Distance به ترتیب وارد می‌کنیم.

### ·       خروجی جدول این لایه معمولا یک فیلد دارد که نشان دهنده فاصله است.

## 5-    آشنایی با ابزار دیگر Analysis Tools: زیرمجموعه Overlay
ابزارهای این گروه برای تحلیل همپوشانی لایه‌ها به کار می‌روند:

### ·       ابزار Erase: حذف بخش‌های مشترک با لایه دیگر

### ·       ابزار Identity: ترکیب لایه‌ها با حفظ ویژگی‌های هر دو

### ·       ابزار Intersect: تولید نواحی مشترک بین چند لایه (محل همپوشانی دقیق)

**استفاده از** **Erase****:**
به عنوان مثال، می‌خواهیم ببینیم چه قطعاتی در حریم 150 متری گسل قرار دارند. برای شروع به لایه حریم 150 متری گسل‌های تهران و
فایل زونینگ طرح تفصیلی نیاز داریم. بعد از انتخاب Erase:

### ·       در قسمت input feature: لایه زونینگ طرح تفصیلی

### ·       در قسمت Erase feature: لایه حریم 150 متری گسل

### ·       خروجی: طرح تفصیلی بدون نواحی داخل حریم گسل. (فقط نواحی امن‌تر باقی می‌مانند.)

## 6-   بررسی پهنه‌هایی که در حریم گسل قرار گرفته‌اند با استفاده از ابزار Intersect
حال می‌خواهیم بفهمیم کدام پهنه‌های طرح تفصیلی و چه سطحی از این پهنه‌ها در حریم گسل قرار دارند:

### ·       انتخاب ابزار Intersect از زیرمجموعه Overlay

### ·       در پنجره Intersect، یکی از لایه‌ها را حریم گسل و یکی را زونینگ طرح تفصیلی انتخاب می‌کنیم.

### ·       خروجی شامل نواحی‌ای است که هم در طرح تفصیلی وجود دارند و هم در محدوده حریم گسل.

### ·       سپس جدول اتریبیوت لایه Intersect را باز می‌کنیم.

### ·       روی فیلد Label جدول راست کلیک کرده و Summarize را انتخاب می‌کنیم.

### ·       در پنجره‌ای که باز می‌شود، input و output مشخص شده؛ فقط ما کادر وسط را باید پر کنیم: فیلد روی Shape Area و Statistic Type روی Sum. (case field= codeiv_label)

### ·       خروجی یک جدول آماری است که نشان می‌دهد هر نوع کاربری چه مقدار از مساحتش در حریم گسل قرار گرفته است.

## 7-   استفاده از ابزار Identity: تحلیل ترکیبی بین لایه‌ها
این ابزار یک لایه را روی لایه دیگر به اصطلاح قالب می‌زند.
به عنوان مثال، می‌خواهیم ببینیم چند درصد از سطح محلات روی گسل قرار گرفته.
لایه محلات را اضافه کرده و جدول آن را باز می‌کنیم.
سپس از ابزار Identity استفاده می‌کنیم:

### ·       لایه اصلی (input feature) را لایه محلات انتخاب می‌کنیم.

### ·       در قسمت Identity feature، لایه حریم یا بافر گسل را انتخاب می‌کنیم.

## 8-    محاسبه درصد مساحت گسلی هر محله

### ·       جدول خروجی مرحله قبل با فرمت csv اکسپورت می‌کنیم و در اکسل باز می‌کنیم.

### ·       در اکسل وارد تب Insert شده و PivotTable را انتخاب می‌کنیم.
**تنظیم فیلدها:**

### ·       قسمت Rows: کد یا نام محله (mah-id)

### ·       قسمت Columns: فاصله یا محدوده بافر (buff_dist)

### ·       قسمت Values: Shape Area، روی shape area کلیک کرده و وارد Value field setting می‌شویم و sum را انتخاب می‌کنیم، سپس در تب  show values as گزینه % of row total را انتخاب می‌کنیم تا درصد همه را محاسبه کند.

**نکته:** اگر اعداد با فرمت تکست شناسایی شده‌اند، باید آن‌ها در اکسل به Number تبدیل کنیم تا محاسبات انجام شود.---
