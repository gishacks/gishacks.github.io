---
title: جلسه ۹ تحلیل فضایی

---

##  انواع روش‌های انتخاب (Selection)

در تب **Map** سه نوع انتخاب اصلی داریم:

1. **Select:** انتخاب محدوده موردنظر به صورت دستی  
2. **Select by Attribute:** انتخاب بر اساس ویژگی‌های توصیفی  
3. **Select by Location:** انتخاب بر اساس موقعیت مکانی

---
 ## متد‌های انتخاب کردن
 به صورت پیش‌فرض اینن متد روی **new selection** قرار دارد که با هر انتخاب جدید، انتخاب قبلی از بین می‌رود.
 ### انواع متد انتخاب
اگر داشته باشیم A و B
 1. New: B
 2. Add: AUB
 3. Remove: A-B
 4. Subset from: AاشتراکB

- در قسمت  **attribute table**، قسمت **select a field** را روی لیبل گذاشته و قسمت‌های بعدی را به پر می‌کنیم، برای مثال:
Label -> is equal to -> مسکونی
- به این بخش از اطلاعات پایگاه داده **query## گفته می‌شود که می‌تواند با استفاده از **add clause** چند جمله داشته باشد.
- روی  **add clause** کلیک کرده و بین "and" و "or" (و، یا، اجتماع و اشتراک) انتخاب می‌کنیم. برای مثال، هنگامی "or" را انتخاب می‌کنیم که بخواهیم قطعات مسکونی یا قطعات بیشتر از 500 متر را انتخاب کنیم. هنگامی از "and" استفاده می‌کنیم که بخواهیم قطعات مسکونی بالای 500 متر را نشان دهیم.
  ## انتخاب کردن در نقشه جمعیت
  پس از باز کردن نقشه جمعیت، در قسمت **select by attribute**، در قسمت فیلد "population" بیشتر از 500 را انتخاب می‌کنیم.
   یعنی فقط قطعات مسکونی که بزرگ‌تر از ۵۰۰ متر هستند.

##  انواع داده‌ها (Field Types)

| نوع داده | توضیح |
|-----------|--------|
| **Integer** | عدد صحیح (مثل 120) |
| **Float / Double** | عدد اعشاری (مثل 15.75) |
| **String / Text** | داده متنی (مثل "مسکونی") |

برای داده‌های متنی فقط برابری یا نابرابری معنا دارد،  
اما برای داده‌های عددی می‌توان از عملگرهای ریاضی استفاده کرد.

---

## تفاوت Null و 0

- به مقداری که محاسبه نشده است،  **null** می‌گوییم. این مقدار می‌تواند صفر یا هزار باشد.
- مقدار **0** مطمُن هستیم که صفر است. 

برای مثال در ستون جمعیت (Population)،  
اگر مقدار Null باشد یعنی هنوز داده‌ای وارد نشده،  
ولی اگر 0 باشد یعنی واقعاً بدون جمعیت است.

---

## محاسبه تراکم جمعیت (Density)

برای محاسبه تراکم جمعیت در هر حوزه:

1. در جدول حوزه‌ها (**Zones**) گزینه **Add Field** را انتخاب می‌کنیم.
 - نام: `Density`
 - نوع داده: `Float` یا `Double`
2. ذخیره می‌کنیم.
3. روی فیلد جدید (**Density**) راست‌کلیک کرده و **Calculate Field** را انتخاب می‌کنیم.
4. فرمول زیر را وارد می‌کنیم:
"Population/ (shape area/ 10000)

این فرمول یعنی جمعیت تقسیم بر مساحت به هکتار (هر هکتار = ۱۰٬۰۰۰ متر مربع).

---

##  خلاصه‌سازی انتخاب‌ها (Summarize)

برای فهمیدن تعداد یا مجموع عوارض انتخاب‌شده:
- کاربری مسکونی کمتر از 200 را انتخاب می‌کنیم.
1.  در  **attribute table**، روی فیلد **Label** راست‌کلیک کرده و **Summarize** را انتخاب می‌کنیم.
2. در قسمت پایین، فیلد دوم را روی **OBJECTID** تنظیم کرده و **Count** را فعال می‌کنیم.  
3. جدول خلاصه‌ای ساخته می‌شود که تعداد هر نوع کاربری را نشان می‌دهد.

---

## تعریف فیلتر دائم (Definition Query)

گاهی می‌خواهیم بدون ساخت لایه جدید و اکسپورت کردن، لایه خود را محدود کنیم.

### مراحل:
1. روی لایه‌ی نقشه (مثلاً *کاربری*) راست‌کلیک کرده و **Properties** را می‌زنیم.  
2. در تب **Definition Query** شرط موردنظر را می‌نویسیم.  
مثال: "shape area < 200"
3. نتیجه: لایه محدود به داده‌های فیلترشده می‌شود ولی لایه جدید ساخته نمی‌شود.

---

## دائمی کردن Selection

برای نگه داشتن انتخاب (Selection) در لایه دو راه داریم:

1. **Export Selected Features:**  
لایه‌ی جدید فقط از داده‌های انتخاب‌شده ساخته می‌شود. (روش سنتی)

2. **Add Field + Calculate Field:**  
با ایجاد فیلد جدید (مثلاً `Selected = 1`) می‌توان انتخاب را ذخیره کرد بدون نیاز به اکسپورت. (روش بهتر)

-  راه دوم بهتر است چون داده‌های اضافی تولید نمی‌کند و هر زمان بخواهیم می‌توانیم Selection را بازسازی کنیم.


در این جلسه ی نهم راجع به selection صحبت می کنیم. در تب map بخش selection   گزینه ی select by attribute را انتخاب کرده![pic1](https://github.com/user-attachments/assets/b8b91e55-9c12-4543-9eb9-779f01ad7e01)
 و پنجره برای ما باز می شود. در بخش select a field ، where را روی label می گذاریم. در نوار بعدی is greater  و در نوار سمت راست عدد 10000 را انتخاب می کنیم. (وقتی هدف فقط مسکونی های بالای 500 متر است and را انتخب می کنیم.![pic2](https://github.com/user-attachments/assets/fad03dbb-6e54-481d-9b52-a92d33b766c5)
 حال با کلیک راست کردن روی لایه attribute table را باز می کنیم.![pic3](https://github.com/user-attachments/assets/e03e3821-f740-46f0-b6a9-cbfecfa2d98b)
 فایل houzeh را از بخش browse باز می کنیم![pic4](https://github.com/user-attachments/assets/080203de-68dd-4958-8d41-649eb6981793)
 و سپس دوباره select by attribute را باز کرده و where را روی population تنظیم کرده و گزینه ی greater than را انتخاب کرده و عدد 500 را وارد میکنیم.![pic5](https://github.com/user-attachments/assets/1716350c-36db-4655-b5a6-2fcb88b6a43f)
 حال در بخش پایین در جدول Add field را انتخاب میکنیم تا پنجره برای ما باز شود. یک فیلد جدید به نام تراکم ایجاد می کنیم و data type را روی double قرار می دهیم گزینه ی save را انتخاب می کنیم.![pic6](https://github.com/user-attachments/assets/63b7c106-e48a-4a90-bb5c-3a948f22de6a)
 فیلدز را می بندیم و اگر به جدول اصلی نگاه کنیم می بینیم که ستون جدید به نام تراکم ایجاد شده است.![pic7](https://github.com/user-attachments/assets/2e178c52-c78a-4931-a46e-4fbe94bfd850)
 حال بخش calculate field را انتخاب می کنیم و در نوار سمت چپ یا همان فیلدز population را انتخاب می کنیم و سپس علامت تقسیم را انتخاب می کنیم سپس دوباره در همان فیلدز shape area را انتخاب می کنیم و دوباره تقسیم را می زنیم و عدد 10000 را انتخاب می کنیم اما این بخش دوم در پرانتز قرار می گیرد. حال در جدولمان روی بخش label راست کلیک می کنیم و summarize را انتخاب می کنیم .![pic10](https://github.com/user-attachments/assets/f4a80c63-e0a4-4de0-abbd-a09f6968cbbc)
 در این بخش field را روی label تنظیم می کنیم و روی maximum قرار می دهیم. حال در نوار پایین object id را انتخاب کرده و روی count تنظیم کرده و ok را می زنیم.
دوباره در نقشه راست![pic8](https://github.com/user-attachments/assets/70eb9a95-513b-41ee-9a46-22318c116672![pic9](https://github.com/user-attachments/assets/bedfefcf-bb65-4a4e-be8b-2ff0bdd68bb7)
)
 کلیک می کنیم و properties را انتخاب می کنیم تا پنجره اش باز شود و به بخش definition query می رویم سپس در بخش where shape area را می زنیم و سپس less than  و در اخر عدد را روی 200 یم گذاریم و اوکی را می زنیم![pic11](https://github.com/user-attachments/assets/4c82565f-01ca-4e98-b2b7-e6a8ad851185)
.
---# جلسه 18 آذر:بخش اول: تمرین تحلیل سطح با استفاده از modelbuilder

## 1-   افزودن Conversion Tool و قرار دادن تصویر اکسپورت‌شده
### ·       وارد Toolbox می‌شویم.
### ·       ابزارهای تبدیل (Conversion) را اضافه می‌کنیم.
### ·       عکس اکسپورت‌شده از سایت را به عنوان Input ابزار Conversion انتخاب می‌کنیم.

## 2-   اجرای Topo to Raster

از Toolbox → Spatial Analyst → Surface → Topo To Raster استفاده می‌کنیم.
در پنجره باز شده:
### ·        Feature layer: خروجی دستور قبلی (لایه‌ای که از Conversion تولید شده) را انتخاب می‌کنیم.
### ·        Type: را روی Point — Elevation قرار می‌دهیم.
### ·       Field: را روی grid-code تنظیم می‌کنیم.
### ·       در نهایت گزینه Auto Layout را می‌زنیم تا ورودی‌ها و لایه‌ها مرتب شوند.

## 3-   اجرای Project Raster
ابزار Project Raster را باز و درگ می‌کنیم.

### ·       Input raster: خروجی مرحله ۲ (Topo to Raster) را انتخاب می‌کنیم.
### ·       Output coordinate system: مقدار 32639 را وارد می‌کنیم (سیستم مختصات خروجی).
خروجی را ذخیره می‌کنیم.

## 4-   اجرای Slope
ابزار Slope را باز می‌کنیم.

### ·       Input: خروجی مرحله ۳ (Project Raster) را انتخاب می‌کنیم.
### ·       Output measurement: را روی Percent قرار می‌دهیم (برای استفاده شهری/ضوابط).
خروجی شیب را ذخیره می‌کنیم.

## 5-   اجرای Aspect
ابزار Aspect را باز می‌کنیم.

### ·        Input raster: خروجی مرحله 3 که واحد آن را تغییر داده‌ایم را انتخاب می‌کنیم.
خروجی Aspect را ذخیره می‌کنیم.

## 6-   اجرای Contour
ابزار Contour را باز می‌کنیم.

### ·       Input raster: خروجی مرحله 3 را انتخاب می‌کنیم.
### ·       Contour interval: را 10 وارد می‌کنیم.
### ·       خروجی کانتور را ذخیره و در سیمبولوژی ضخامت را مطابق نیاز تنظیم می‌کنیم.

## 7-   اجرای Hillshade
ابزار Hillshade را باز می‌کنیم.

### ·        Input raster: خروجی مرحله 3 را انتخاب می‌کنیم.
### ·        تنظیمات Azimuth / Altitude را طبق نیاز فصل/نمایش اعمال می‌کنیم (در جلسۀ قبل نکات مربوط به Azimuth و Altitude توضیح داده شده است).
خروجی Hillshade را ذخیره می‌کنیم.

## 8-   اجرا، افزودن به نمایش و پاک‌سازی آدرس‌های پیش‌فرض

### ·       همه ابزارها را یک بار Run می‌کنیم و خروجی‌ها را Add To Display می‌کنیم تا در نقشه نمایش داده شوند.
### ·        برای اولین ورودی مدل در پنجره ابزار مدل:روی آن دو بار کلیک می‌کنیم، آدرسی که زیرش به صورت پیش‌فرض قرار گرفته را پاک می‌کنیم و OK می‌زنیم (تا مسیر پیش‌فرض حذف شود).
### ·        روی اولین ورودی مدل راست‌کلیک می‌کنیم، Parameters را می‌زنیم و از تب‌های بالای صفحه Save می‌کنیم تا پارامتر ذخیره شود.
### ·       مدل را می‌بندیم (Close).

## 9-   تبدیل ابزارها و خروجی‌ها به پارامتر در ModelBuilder

### ·        در پنجره Catalog → Geoprocessing راست‌کلیک می‌کنیم روی مدل که سیو کردیم و Edit را انتخاب می‌کنیم تا ModelBuilder باز شود.
### ·        داخل ModelBuilder روی ابزار Topo to Raster راست‌کلیک می‌کنیم و:

### ·        Create Variable را انتخاب می‌کنیم.
### ·       نوع متغیر را از From Parameter می‌گذاریم و Primary type of input data را تعیین می‌کنیم (تا ورودی به عنوان پارامتر مدل شناخته شود).
### ·       خروجی که تولید می‌شود را روی پارامتر مربوطه می‌زنیم.
### ·       تنها خروجی‌های نهایی (مثلاً Slope، Aspect، Contour، Hillshade) را راست‌کلیک کرده و گزینهMake Parameter (یا معرفی به عنوان پارامتر) را انتخاب می‌کنیم.
### ·       آدرس‌های پیش‌فرض همه پارامترها را یک‌به‌یک کلیک کرده و پاک می‌کنیم تا مسیر پیش‌فرض حذف شود (تا کاربر در زمان اجرای مدل خود مسیر خروجی را انتخاب کند-**وجود باگ**).
مدل را می‌بندیم و ذخیره می‌کنیم.

## 10- اجرای مدل به صورت پارامتریک
مدل را دوباره باز می‌کنیم؛ در کادر اول Input وقتی باز شد، اولین ورودی مدلمان که اسمش با “output” شروع شده را انتخاب می‌کنیم (همان ورودی‌ای که برای Topo to Raster ساختیم).
سپس مدل را Run می‌کنیم. خروجی‌ها بر اساس پارامترها تولید و در کادر نمایش اضافه می‌شوند.

## 11- بهبود نام‌گذاری و ترتیب پارامترها در Catalog
در پنجره Catalog هدف‌مان این است که لیست پارامترها به این ترتیب نمایش داده شود:

### ·       Input dem layer
### ·       Output slope
### ·       Output aspect
### ·       Output contour
### ·       Output hillshade

برای این کار در Catalog روی مدل‌مان راست‌کلیک می‌کنیم و Edit را می‌زنیم تا ModelBuilder باز شود.
روی اولین ورودی راست‌کلیک می‌کنیم و Rename را می‌زنیم؛ اسمش را می‌گذاریم Input dem layer.
به همان ترتیب، برای هر خروجی (Slope / Aspect / Contour / Hillshade) رویشان راست‌کلیک و Rename می‌کنیم و اسامی مورد نظر (Output slope, Output aspect, Output contour, Output hillshade) را می‌گذاریم.
سپس از همان پنجره ModelBuilder، روی مدل کلیک راست می‌کنیم، Properties را باز می‌کنیم و هم Name و هم Label مدل را مطابق نیاز تغییر می‌دهیم (تا در Catalog و جعبه‌ابزار خواناتر باشد).
ذخیرهمی‌کنیم و مدل را می‌بندیم.

# بخش دوم جلسه 18 آذر: تحلیل‌های از جنس فاصله
در تحلیل‌های فاصله، دو نوع فاصله داریم:

نزدیکی (Proximity): وابسته به وجود یا عدم وجود راه نیست؛ مستقیم فاصله هندسی را محاسبه می‌کنیم.
دسترسی (Accessibility): مبتنی بر راه‌هاست و مسیرها و شبکه راه دخیل‌اند.
**برای این تحلیل‌ها بهترین محیط، رستر است.**
در ابتدا:
هم لایه مناطق شهرداری را باز می‌کنیم.
هم لایه گسل را اضافه می‌کنیم.

**مسیر ابزار:**
Spatial Analyst → Distance → Legacy → Euclidean Distance
### ·       این ابزار فاصله هر سلول را تا نزدیک‌ترین نقطه/خط عارضه محاسبه می‌کند.

**تنظیم ورودی (****Input****)**
در اولین کادر ابزار:
لایه گسل را به عنوان ورودی انتخاب می‌کنیم.
این لایه همان عارضه‌ای است که می‌خواهیم فاصله تا آن محاسبه شود.

**دو پارامتر مهم در تحلیل‌های رستری:**
در تحلیل‌های فاصله، حتماً باید دو مورد را تعیین کنیم:

### ·       **Extent****:** محدوده کار؛ تعیین می‌کند محاسبه دقیقاً روی چه محدوده‌ای انجام شود.
### ·       **Cell Size****:** اندازه سلول؛ تعیین می‌کند دقت خروجی چقدر باشد.
### ·       نرم‌افزار خودش یک عدد پیشنهادی می‌دهد.
### ·       اگر دقت بیشتر بخواهیم، سلول را کوچک‌تر انتخاب می‌کنیم.

**تنظیم** **extent** **و** **cell size** **در** **Environment**
برای اینکه این پارامترها دست ما باشد، وارد تب Environment می‌شویم.

در بخش Processing Extent:
### ·       گزینه سوم را انتخاب می‌کنیم (همان گزینه‌ای که شبیه یک لایه است).
### ·       سپس یک لایه را انتخاب می‌کنیم تا دربردارنده محدوده تحلیل ما باشد و بر اساس آن محدوده تعیین شود (مثلاً لایه مناطق شهرداری).

در بخش Cell Size:
### ·       مقدار مورد نظر را وارد می‌کنیم؛ مثلاً 100.
### ·       در حالت عادی، ورودی ابزار را به عنوان محدوده تحلیل استفاده می‌کند، اما ما با تنظیمات Environment کنترل دقیق‌تری داریم.

**نکته:**ابزار به طور پیش‌فرض فاصله تا نزدیک‌ترین گسل را محاسبه می‌کند.
اگر لازم باشد می‌توانیم تعیین کنیم فقط تا یک گسل خاص فاصله حساب شود (با انتخاب زیرمجموعه لایه یا تعریف Selection).

**تنظیم سیمبولوژی نتیجه**
بعد از تولید رستر فاصله، در بخش Symbology می‌توانیم:
### ·       Stretch: نمایش طیفی (پیوسته)
### ·        Classify: نمایش طبقه‌بندی‌شده (مثلاً ۵ دسته فاصله)
این دو برای خوانایی و تحلیل کاربردی ضروری‌اند.
